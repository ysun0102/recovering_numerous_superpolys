# Github_Supplementary_Material

## Requirments (tested on Ubuntu 20.04):
1. Sage 10.3: https://www.sagemath.org
2. Singular 4.4.0: https://www.singular.uni-kl.de/index.php/singular-download/109.html
3. python-sat 1.8.dev13:
>pip3 install python-sat \
pip3 install pycryptosat==5.11.21



## Files:

### ./Data_spolys
The polynomials were obtained in the Offline Phase of the practical attack.

### ./Sat_solve

+ ***solve.py***: Python implementation of Algorithm 4("Solving the system constructed by the superpolys by testing").
    + ***line285***: Generate a secret key by random
    + ***line289***: Use a preset key (Hexadecimal)
+ ***polynomials***:  A folder storing a series of polynomial sets.
+ ***Output Information (on-screen)***:
    + ***"round 2"***: The index of the iteration.
    + ***"untested vars"***: The list of indices of the untested secret variables, sorted by the increasing order of the appearing times.
    + ***"to test var"***: The index of the variable to be tested.
    + ***"current_assigns"***: The list of the assignments determined in previous iterations. Specifically, ['k58=1', 'k61=0'] means k58=1 and k61=0, which obtains from previous tests.
    + ***"both_has_solutions"***: The list of indices of variables whose values cannot be determined.
    + ***"testing k61 == 0"***: Testing whether k61 == 0 leads to a contradiction.
    + ***"cnf:  ['k58=1', 'k59=1', 'k61=0'] "***: Assigning {k58 = 1, k59 = 1, k61 = 0}.
    + ***"Find solution~~~"***: Found a soltuion by assigning {k58 = 1, k59 = 1, k61 = 0}.
    + ***"testing k61 == 1"***: Testing whether k61 == 1 leads to a contradiction.
    + ***"cnf:  ['k58=1', 'k59=1', 'k61=1']  "***: Assigning {k58 = 1, k59 = 1, k61 = 1}.
    + ***"No solution!"***: Found a contradiciton by assigning {k58 = 1, k59 = 1, k61 = 1}, which implies k61 == 0 must hold.

---------------------------------------
...\
2024-10-08 04:36:19.673821\
round 2 \
untested vars:  [9, 7, 22, 5, 10, 20, 18, 8, 23, 6, 35, 4, 3, 11, 66, 41, 33, 31, 65, 79, 16, 30, 13, 50, 15, 40, 37, 14, 39, 38, 17, 54, 43, 1, 52, 0, 49, 75, 29, 55, 69, 53, 2, 12, 21, 77, 28, 56, 48, 67, 64, 19, 24, 42, 70, 51, 71, 27, 76, 73, 78, 26, 68, 45, 47, 72, 36, 25, 32, 63, 34, 46, 57, 44, 62, 74, 60]\
to test var: 61\
current_assigns:  ['k58=1', 'k59=1'] 2 \
both_has_solutions:  [] 0\
testing k61 == 0\
cnf:  ['k58=1', 'k59=1', 'k61=0'] 

Find solution~~~

testing k61 == 1\
cnf:  ['k58=1', 'k59=1', 'k61=1'] 

No solution!

round is done

2024-10-08 04:42:57.665555\
round 3

...

------------------------------

### ./GroebnerBasis_solve

+ ***GB_sage***: Solving equations by the Groebner basis method in Sage
    + ***gb.py***: The script for computing the Groebner basis (by Polybori) in Sage:
        + ***line48~50***: Choose the secret key.
    + ***logs***: Some logs show that the Groebner basis method fails to solve the whole system directly. Related keys are at the top of the logs.

+ ***GB_Singular***
    + ***singular_cmds***: Files containing the Singular commands generated by the "generate_singular_cmd.py" script.
    + ***logs***: Some logs show that the Groebner basis method fails to solve the whole system directly. Related keys are at the top of the logs.
    + ***generate_singular_cmd.py***: Generate Singular commands that can be executed on Singular:
        + ***line87~89***: Choose the secret key.

### ./Statistics_spolys
+ ***sp_var_monomial.py***: Statistics of "the number of monomials involving a given variable in an equation".
    + ***line3***: Choose the key variable k0~k79.
+ ***sp_degree.py***: Statistics of the degrees of the polynomials.
+ ***sp_monomial.py***: Statistics of the monomial numbers of the polynomials.
+ ***vars_frequency_832.py***: Statistics of the appearing times of the secret variables.

### ./reproduce_gurobi_presolve_bug

+ Gurobi (ver11.0.3) may recover wrong superpolys if "presolve()" is used. Here is an example to reproduce this bug.
